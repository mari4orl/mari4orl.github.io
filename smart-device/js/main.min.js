"use strict";var userName,userPhone,messageContent,anchor,phoneInput,accList=document.querySelectorAll(".acc"),openBtn=document.querySelector(".navigation__btn"),modalElem=document.querySelector(".modal"),overlayElem=document.querySelector(".modal__overlay"),closeBtn=document.querySelector(".modal__close-btn"),isStorageSupport=!0,anchorList=document.querySelectorAll(".anchor-link"),phoneInputList=document.querySelectorAll(".phone"),ESC_KEYCODE=27;function onEscKeyDown(e){e.keyCode===ESC_KEYCODE&&(modalElem.classList.add("modal--closed"),document.body.classList.remove("stop-scrolling"))}function closeModal(){modalElem.classList.contains("modal--closed")||(modalElem.classList.add("modal--closed"),document.removeEventListener("keydown",onEscKeyDown),document.body.classList.remove("stop-scrolling"))}try{localStorage.getItem("userName"),localStorage.getItem("userPhone"),localStorage.getItem("messageContent")}catch(e){isStorageSupport=!1}openBtn&&(userName=modalElem.querySelector("[id=modal-name]"),userPhone=modalElem.querySelector("[id=modal-phone]"),messageContent=modalElem.querySelector("[id=modal-message]"),openBtn.addEventListener("click",function(e){e.preventDefault(),document.body.classList.add("stop-scrolling"),modalElem.classList.contains("modal--closed")&&(modalElem.classList.remove("modal--closed"),document.addEventListener("keydown",onEscKeyDown)),userName.focus()}),modalElem.addEventListener("submit",function(e){userName.value&&userPhone.value&&""!==messageContent.value?isStorageSupport&&(localStorage.setItem("userName",userName.value),localStorage.setItem("userPhone",userPhone.value)):(e.preventDefault(),modalElem.classList.remove("modal-error"),modalElem.offsetWidth,modalElem.classList.add("modal-error"),userName.value?userPhone.value?""===messageContent.value&&messageContent.focus():userPhone.focus():userName.focus())})),closeBtn.addEventListener("click",closeModal),overlayElem.addEventListener("click",closeModal);for(var i=0;i<accList.length;i++){var acc=accList[i];acc.classList.remove("nojs"),acc.addEventListener("click",function(e){if(e.target.checked)for(var o=0;o<accList.length;o++)accList[o].checked=accList[o]===e.target})}for(i=0;i<anchorList.length;i++)(anchor=anchorList[i]).addEventListener("click",function(e){e.preventDefault();var o=("SPAN"===e.target.nodeName?e.target.parentNode:e.target).getAttribute("href").substr(1);window.scrollTo({top:document.getElementById(o).offsetTop,left:0,behavior:"smooth"})});for(i=0;i<phoneInputList.length;i++)(phoneInput=phoneInputList[i]).addEventListener("click",addPhone),phoneInput.addEventListener("keydown",checkPhone);function addPhone(e){var o=e.target;o.value.length||(o.value="+7(")}function checkPhone(e){var o=e.target,t=o.value.length;if(!/\d/.test(e.key)){if(8===e.keyCode||9===e.keyCode)return;e.preventDefault()}0===t&&(o.value=o.value+"+7("),2===t&&(o.value=o.value+"("),6===t&&(o.value=o.value+") "),10===t&&(o.value=o.value+"-"),13===t&&(o.value=o.value+"-"),16<t&&(o.value=o.value.substring(0,o.value.length-1))}
